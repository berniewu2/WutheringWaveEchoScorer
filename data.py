damage_composition = {
    "Jinhsi": {
        "composition": {
            "Basic Attack": 2.0,
            "Heavy Attack": 0.0,
            "Resonance Liberation": 20.0,
            "Resonance Skill": 72.0,
            "Other": 6.0,
            "type": "Carry",
        },
        "score_needed": 490.0,
    },
    "Jiyan": {
        "composition": {
            "Basic Attack": 2.0,
            "Heavy Attack": 68.0,
            "Resonance Liberation": 0.0,
            "Resonance Skill": 11.0,
            "Other": 19.0,
            "type": "Carry",
        },
        "score_needed": 487.6,
    },
    "Changli": {
        "composition": {
            "Basic Attack": 1.0,
            "Heavy Attack": 0.0,
            "Resonance Liberation": 27.0,
            "Resonance Skill": 59.0,
            "Other": 13.0,
            "type": "Carry",
        },
        "score_needed": 482.3,
    },
    "Encore": {
        "composition": {
            "Basic Attack": 59.0,
            "Heavy Attack": 2.0,
            "Resonance Liberation": 5.0,
            "Resonance Skill": 12.0,
            "Other": 22.0,
            "type": "Carry",
        },
        "score_needed": 482.4,
    },
    "Jianxin": { # 鑒心
        "composition": {
            "Basic Attack": 24.0,
            "Heavy Attack": 31.0,
            "Resonance Liberation": 27.0,
            "Resonance Skill": 6.0,
            "Other": 12.0,
            "type": "Support",
        },
        "score_needed": 491.8,
    },
    "Calcharo": {
        "composition": {
            "Basic Attack": 20.0,
            "Heavy Attack": 3.0,
            "Resonance Liberation": 52.0,
            "Resonance Skill": 5.0,
            "Other": 20.0,
            "type": "Carry",
        },
        "score_needed": 478.3,
    },
    "Lingyang": { # 凌陽
        "composition": {
            "Basic Attack": 40.0,
            "Heavy Attack": 4.0,
            "Resonance Liberation": 4.0,
            "Resonance Skill": 30.0,
            "Other": 22.0,
            "type": "Carry",
        },
        "score_needed": 475.2,
    },
    "Yinlin": { # 吟霖
        "composition": {
            "Basic Attack": 8.0,
            "Heavy Attack": 20.0,
            "Resonance Liberation": 21.0,
            "Resonance Skill": 37.0,
            "Other": 14.0,
            "type": "Carry",
        },
        "score_needed": 474.7,
    },
    "DarkRover": {
        "composition": {
            "Basic Attack": 20.0,
            "Heavy Attack": 5.0,
            "Resonance Liberation": 30.0,
            "Resonance Skill": 25.0,
            "Other": 20.0,
            "type": "Carry",
        },
        "score_needed": 473.0,
    },
    "LightRover": {
        "composition": {
            "Basic Attack": 11.0,
            "Heavy Attack": 31.0,
            "Resonance Liberation": 23.0,
            "Resonance Skill": 21.0,
            "Other": 14.0,
            "type": "Carry",
        },
        "score_needed": 473.7,
    },
    "Aalto": { # 秋水
        "composition": {
            "Basic Attack": 25.0,
            "Heavy Attack": 0.0,
            "Resonance Liberation": 22.0,
            "Resonance Skill": 33.0,
            "Other": 20.0,
            "type": "Support",
        },
        "score_needed": 474.8,
    },
    "Mortefi": {
        "composition": {
            "Basic Attack": 15.0,
            "Heavy Attack": 0.0,
            "Resonance Liberation": 48.0,
            "Resonance Skill": 31.0,
            "Other": 6.0,
            "type": "Support",
        },
        "score_needed": 496.0,
    },
    "Danjin": {
        "composition": {
            "Basic Attack": 8.0,
            "Heavy Attack": 32.0,
            "Resonance Liberation": 20.0,
            "Resonance Skill": 22.0,
            "Other": 18.0,
            "type": "Carry",
        },
        "score_needed": 474.4,
    },
    "Chixia": {
        "composition": {
            "Basic Attack": 6.0,
            "Heavy Attack": 0.0,
            "Resonance Liberation": 35.0,
            "Resonance Skill": 46.0,
            "Other": 13.0,
            "type": "Support",
        },
        "score_needed": 478.6,
    },
    "Sanhua": {
        "composition": {
            "Basic Attack": 2.0,
            "Heavy Attack": 30.0,
            "Resonance Liberation": 32.0,
            "Resonance Skill": 30.0,
            "Other": 6.0,
            "type": "Support",
        },
        "score_needed": 474.4,
    },
    "Yuanwu": {
        "composition": {
            "Basic Attack": 5.0,
            "Heavy Attack": 0.0,
            "Resonance Liberation": 46.0,
            "Resonance Skill": 45.0,
            "Other": 4.0,
            "type": "Support",
        },
        "score_needed": 499.1,
    },
    "Yangyang": {
        "composition": {
            "Basic Attack": 5.0,
            "Heavy Attack": 28.0,
            "Resonance Liberation": 40.0,
            "Resonance Skill": 22.0,
            "Other": 5.0,
            "type": "Support",
        },
        "score_needed": 494.9,
    },
    "Taoqi": {
        "composition": {
            "Basic Attack": 8.0,
            "Heavy Attack": 0.0,
            "Resonance Liberation": 50.0,
            "Resonance Skill": 38.0,
            "Other": 4.0,
            "type": "Support",
        },
        "score_needed": 501.3,
    },
    "Zhezhi": {
        "composition": {
            "Basic Attack": 54.0,
            "Heavy Attack": 18.0,
            "Resonance Liberation": 0.0,
            "Resonance Skill": 21.0,
            "Other": 7.0,
            "type": "Support",
        },
        "score_needed": 479.5,
    },
    "Xiangli Yao": {
        "composition": {
            "Basic Attack": 13.0,
            "Heavy Attack": 5.0,
            "Resonance Liberation": 62.0,
            "Resonance Skill": 7.0,
            "Other": 13.0,
            "type": "Carry",
        },
        "score_needed": 484.2,
    },
    "Shorekeeper": {
        "composition": {
            "Basic Attack": 1.0,
            "Heavy Attack": 1.0,
            "Resonance Liberation": 97.0,
            "Resonance Skill": 0.0,
            "Other": 1.0,
            "type": "HP Healer",
        },
        "score_needed": 398.5,
    },
    "Cihu": {
        "composition": {
            "Basic Attack": 11.0,
            "Heavy Attack": 8.0,
            "Resonance Liberation": 29.0,
            "Resonance Skill": 33.0,
            "Other": 19.0,
            "type": "Support",
        },
        "score_needed": 492.4,
    },
    "Camellya": { # 椿
        "composition": {
            "Basic Attack": 66.0,
            "Heavy Attack": 2.0,
            "Resonance Liberation": 22.0,
            "Resonance Skill": 0.0,
            "Other": 10.0,
            "type": "Carry",
        },
        "score_needed": 486.3,
    },
    "Lumi": { # 燈燈
        "composition": {
            "Basic Attack": 64.0,
            "Heavy Attack": 0.0,
            "Resonance Liberation": 20.0,
            "Resonance Skill": 8.0,
            "Other": 8.0,
            "type": "Support",
        },
        "score_needed": 485.2,
    },
    "Carlotta": {
        "composition": {
            "Basic Attack": 11.0,
            "Heavy Attack": 0.0,
            "Resonance Liberation": 0.0,
            "Resonance Skill": 75.0,
            "Other": 14.0,
        },
        "score_needed": 491.5,
    },
    "Roccia": {
        "composition": {
            "Basic Attack": 3.0,
            "Heavy Attack": 68.0,
            "Resonance Liberation": 0.0,
            "Resonance Skill": 12.0,
            "Other": 17.0,
            "type": "Carry",
        },
        "score_needed": 487.5,
    },
    "Phoebe": {
        "composition": {
            "Basic Attack": 9.0,
            "Heavy Attack": 54.0,
            "Resonance Liberation": 12.0,
            "Resonance Skill": 4.0,
            "Other": 21.0,
            "type": "Carry",
        },
        "score_needed": 479.0,
    },
    "Brant": {
        "composition": {
            "Basic Attack": 62.0,
            "Heavy Attack": 0.0,
            "Resonance Liberation": 12.0,
            "Resonance Skill": 12.0,
            "Other": 14.0,
            "type": "Brant",
        },
        "score_needed": 454.9,
    },
    "Cantarella": {
        "composition": {
            "Basic Attack": 79.0,
            "Heavy Attack": 6.0,
            "Resonance Liberation": 0.0,
            "Resonance Skill": 6.0,
            "Other": 9.0,
            "type": "Support",
        },
        "score_needed": 493.9,
    },
    "WindRover": {
        "composition": {
            "Basic Attack": 8.0,
            "Heavy Attack": 0.0,
            "Resonance Liberation": 17.0,
            "Resonance Skill": 62.0,
            "Other": 13.0,
            "type": "Support",
        },
        "score_needed": 483.9,
    },
    "Zani": {
        "composition": {
            "Basic Attack": 3.0,
            "Heavy Attack": 76.0,
            "Resonance Liberation": 12.0,
            "Resonance Skill": 1.0,
            "Other": 9.0,
            "type": "Carry",
        },
        "score_needed": 492.0,
    },
    "Ciaccona": {
        "composition": {
            "Basic Attack": 15.0,
            "Heavy Attack": 23.0,
            "Resonance Liberation": 47.0,
            "Resonance Skill": 6.0,
            "Other": 9.0,
            "type": "Support",
        },
        "score_needed": 495.4,
    },
    "Verina": {
        "composition": {
            "Basic Attack": 0.0,
            "Heavy Attack": 0.0,
            "Resonance Liberation": 0.0,
            "Resonance Skill": 0.0,
            "Other": 0.0,
            "type": "ATK Healer",
        },
        "score_needed": 442.9,
    },
    "Baizhi": {
        "composition": {
            "Basic Attack": 0.0,
            "Heavy Attack": 0.0,
            "Resonance Liberation": 0.0,
            "Resonance Skill": 0.0,
            "Other": 0.0,
            "type": "Support",
        },
        "score_needed": 437.3,
    },
}

for char_data in damage_composition.values():
    comp = char_data["composition"]
    for k in list(comp.keys()):
        if k != "type":
            comp[k] = comp[k] * 0.01


multiplier_weights = {
    "Carry": {
        "Crit. Rate": 1.8,
        "Crit. DMG": 0.9,
        "ATK%": 1.0,
        "ATK": 0.1,
        "Elemental Damage Bonus": 1.0,
        "Special Damage": "n",
        "Energy Regen": [40, 0.5, 0], # threshold, multiplier
    },
    "Support": {
        "Crit. Rate": 1.8,
        "Crit. DMG": 0.9,
        "ATK%": 1.0,
        "ATK": 0.1,
        "Elemental Damage Bonus": 1.0,
        "Special Damage": "n",  
        "Energy Regen": [40, 1.0, 0.3],
    },
    "ATK Healer": {
        "Crit. DMG": 0.1,
        "ATK": 0.12,
        "ATK%": 1.2,
        "HP%": 1.0,
        "DEF%": 0.1,
        "Healing Bonus": 2.0,
        "Elemental Damage Bonus": 1.0,
        "Special Damage": "n",  
        "Energy Regen": [100, 1.0, 0.5],
    },
    "HP Healer": {
        "Crit. DMG": 0.1,
        "HP%": 1.0,
        "HP": 0.01,
        "DEF%": 0.1,
        "Healing Bonus": 2.0,
        "Elemental Damage Bonus": 1.0,
        "Special Damage": "n",  
        "Energy Regen": [100, 1.0, 0.5],
    },
    "Healer": {
        "Crit. DMG": 0.1,
        "Healing Bonus": 2.0,
        "Elemental Damage Bonus": 1.0,
        "Special Damage": "n",  
        "Energy Regen": [80, 1.0, 0.5],
    },
    "Defense Support": {
        "Crit. Rate": 1.8,
        "Crit. DMG": 0.9,
        "DEF%": 1.0,
        "DEF": 0.08,
        "Elemental Damage Bonus": 1.0,
        "Special Damage": "n",  
        "Energy Regen": [40, 1.0, 0.3],
    },
    "Brant": {
        "Energy Regen": [180, 1.0, 0.0],
        "ATK%": 0.5,
        "ATK": 0.05,
        "Crit. Rate": 1.8,
        "Crit. DMG": 0.9,
        "Elemental Damage Bonus": 1.0,
        "Special Damage": "n",
    },
}

VALID_MAJOR_PROPERTY = [
    "HP",
    "ATK",
    "DEF",
    "Electro DMG Bonus",
    "Glacio DMG Bonus",
    "Havoc DMG Bonus",
    "Fusion DMG Bonus",
    "Aero DMG Bonus",
    "Spectro DMG Bonus",
    "Energy Regen",
    "Crit. DMG",
    "Crit. Rate",
    "Healing Bonus",
]


VALID_MINOR_PROPERTY = [
    "ATK",
    "HP",
    "DEF",
    "Energy Regen",
    "Crit. Rate",
    "Crit. DMG",
    "Basic Attack DMG Bonus",
    "Heavy Attack DMG Bonus",
    "Resonance Skill DMG",
    "Resonance Liberation",
]